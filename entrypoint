#!/usr/bin/env bash

################################################################################
# Set Variables
################################################################################
NAME="$1"
TAG="$2"
GIT_SHA="$3"
NAMESPACE="$4"
ENVIRONMENT="$5"
REPOSITORY="${GITHUB_REPOSITORY/switcher-ie\//}"

echo "NAME is $NAME"
echo "TAG is $TAG"
echo "GIT_SHA is $GIT_SHA"
echo "NAMESPACE is $NAMESPACE"
echo "ENVIRONMENT is $ENVIRONMENT"
echo "REPOSITORY is $REPOSITORY"
echo "GITHUB_WORKSPACE is $GITHUB_WORKSPACE"

# Build Image

/deploy/build "${TAG}" "${GIT_SHA}" "${REPOSITORY}"

# # Push Image

/deploy/push "${TAG}"

# # # Promote

# /deploy/promote "${{ steps.namespace.outputs.namespace }}" "staging" "${{ steps.tag.outputs.tag }}"

# # # Notify Slack

# /deploy/slack "${{ secrets.SLACK_WEBHOOK }}" "development" "Vertical Products" "$GITHUB_SHA" "https://github.com/$GITHUB_REPOSITORY/commit/$GITHUB_SHA" "${{ steps.tag.outputs.tag }}" "${{ steps.namespace.outputs.namespace }}"
