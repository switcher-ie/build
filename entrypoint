#!/usr/bin/env bash

set -eo pipefail

################################################################################
# Set Variables
################################################################################

TAG="${GITHUB_SHA::7}"
APP="${GITHUB_REPOSITORY/switcher-ie\//}"

################################################################################
# Set Path
################################################################################

export PATH="$PATH:/bin"

################################################################################
# Login to ECR
################################################################################

$(aws ecr get-login --no-include-email)

################################################################################
# Build Image
################################################################################

build "${TAG}" "${GITHUB_SHA}" "${APP}"

################################################################################
# Push Image
################################################################################

push "${TAG}" "${APP}"
